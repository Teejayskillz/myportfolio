{% extends 'base.html' %}
{% load static %}

{% block title %}Checkout - {{ product.name }} | LagosWebDev{% endblock %}

{% block content %}
<section class="checkout-section">
    <div class="checkout-card">
        <h2>Checkout</h2>
        <p>You are about to purchase <strong>{{ product.name }}</strong>.</p>

        <!-- ✅ SINGLE FORM ONLY -->
        <form method="POST">
            {% csrf_token %}

            <div class="mb-3">
                <label class="form-label">Full Name</label>
                <input type="text" class="form-control" name="buyer_name" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Email Address</label>
                <input type="email" class="form-control" name="buyer_email" required>
            </div>

            <div class="checkout-summary">
                <h4>Order Summary</h4>
                <p>Product: {{ product.name }}</p>
                <p>Price: ₦{{ product.price|floatformat:2 }}</p>
            </div>

            {% if active_gateways %}
            <div class="mt-4">
                <h4>Choose Payment Method</h4>

                {% for gateway in active_gateways %}
                <div class="form-check mb-2">
                    <input class="form-check-input" type="radio" name="gateway" value="{{ gateway.name }}" required>
                    <label class="form-check-label">
                        Pay with {{ gateway.name|title }}
                    </label>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="text-warning mt-3">
                No payment gateways are currently active.
            </p>
            {% endif %}

            <button type="submit" class="btn btn-netflix-primary btn-checkout mt-3">
                Proceed to Payment
            </button>

        </form>
    </div>
</section>
{% endblock %}