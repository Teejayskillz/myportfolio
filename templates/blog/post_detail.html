{% extends 'base.html' %}
{% load static %}

{% block title %}{{ post.title }} | LagosWebDev Blog{% endblock %}

{% block meta_description %}{{ post.content|striptags|truncatewords:25 }}{% endblock %}

{% block content %}
<style>
    /* --- POST DETAIL PAGE SPECIFIC STYLES --- */

    /* Post Header Section */
    .post-header {
        padding: 6rem 0;
        position: relative;
        text-align: center;
        color: var(--netflix-white);
        background-size: cover;
        background-position: center;
    }
    .post-header::before {
        content: '';
        position: absolute;
        top: 0; left: 0; right: 0; bottom: 0;
        background: linear-gradient(rgba(20,20,20,0.5) 0%, rgba(20,20,20,1) 100%);
        z-index: 1;
    }
    .post-header .container {
        position: relative;
        z-index: 2;
    }
    .post-title-main {
        font-size: 3.5rem;
        font-weight: 900;
        text-shadow: 0 4px 20px rgba(0,0,0,0.7);
    }
    .post-meta-main {
        font-size: 1rem;
        color: var(--netflix-light-gray);
        margin-top: 1rem;
    }
    .post-meta-main i {
        margin-right: 0.5rem;
        color: var(--netflix-red);
    }
    .post-categories-main a {
        display: inline-block;
        background-color: rgba(255,255,255,0.1);
        color: var(--netflix-white);
        padding: 0.4rem 1rem;
        border-radius: 20px;
        text-decoration: none;
        margin: 0.5rem 0.25rem;
        font-size: 0.9rem;
        transition: all 0.3s ease;
        border: 1px solid rgba(255,255,255,0.2);
    }
    .post-categories-main a:hover {
        background-color: var(--netflix-red);
        color: var(--netflix-white);
        border-color: var(--netflix-red);
    }

    /* Article Body */
    .article-body {
        padding: 4rem 0;
        font-size: 1.15rem;
        line-height: 1.8;
        color: var(--netflix-light-gray);
    }
    .article-body h2, .article-body h3, .article-body h4 {
        color: var(--netflix-white);
        font-weight: 700;
        margin-top: 2.5rem;
        margin-bottom: 1.5rem;
        line-height: 1.4;
    }
    .article-body p {
        margin-bottom: 1.5rem;
    }
    .article-body a {
        color: var(--netflix-red);
        text-decoration: none;
        border-bottom: 1px dotted var(--netflix-red);
        transition: all 0.3s ease;
    }
    .article-body a:hover {
        color: var(--netflix-white);
        background-color: var(--netflix-red);
        border-bottom-color: var(--netflix-red);
    }
    .article-body blockquote {
        border-left: 4px solid var(--netflix-red);
        padding: 1rem 1.5rem;
        margin: 2rem 0;
        font-style: italic;
        background-color: var(--netflix-dark-gray);
        color: var(--netflix-light-gray);
        border-radius: 0 8px 8px 0;
    }
    .article-body img {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
        margin: 2rem 0;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    }
    .article-body pre {
        background-color: #1f1f1f;
        border: 1px solid var(--netflix-medium-gray);
        padding: 1.5rem;
        border-radius: 8px;
        overflow-x: auto;
        font-size: 0.95rem;
        color: #d4d4d4;
    }
    .article-body code {
        background-color: var(--netflix-medium-gray);
        color: var(--netflix-red);
        padding: 0.2rem 0.4rem;
        border-radius: 4px;
        font-size: 90%;
    }
    .article-body pre code {
        background-color: transparent;
        color: inherit;
        padding: 0;
    }

    /* Post Footer */
    .post-footer {
        border-top: 1px solid var(--netflix-medium-gray);
        padding-top: 2rem;
    }
    .social-share a {
        color: var(--netflix-light-gray);
        font-size: 1.5rem;
        margin-left: 1rem;
        transition: all 0.3s ease;
    }
    .social-share a:hover {
        color: var(--netflix-red);
        transform: scale(1.2);
    }

    /* Author Box */
    .author-box {
        background-color: var(--netflix-dark-gray);
        border-radius: 8px;
        padding: 2rem;
        margin-top: 4rem;
        display: flex;
        align-items: center;
        border: 1px solid var(--netflix-medium-gray);
    }
    .author-avatar {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        margin-right: 1.5rem;
    }

    /* Comments Section */
    .comments-section {
        margin-top: 4rem;
    }

</style>

<!-- POST HERO HEADER -->
<header class="post-header" style="background-image: url('{% if post.image %}{{ post.image.url }}{% else %}{% static '/default/imagejpg' %}{% endif %}');">
    <div class="container">
        <h1 class="post-title-main">{{ post.title }}</h1>
        <div class="post-meta-main">
            <span><i class="fas fa-calendar-alt"></i>{{ post.publish|date:"F j, Y" }}</span>
            <span class="mx-2">|</span>
            <span><i class="fas fa-user"></i>{{ post.author.get_full_name|default:post.author.username }}</span>
        </div>
        {% if post.categories.all %}
        <div class="mt-3 post-categories-main">
            {% for cat in post.categories.all %}
                <a href="{% url 'blog:post_list_by_category' category_slug=cat.slug %}">{{ cat.name }}</a>
            {% endfor %}
        </div>
        {% endif %}
    </div>
</header>

<div class="article-body">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <article>
                    <!-- Main Post Content -->
                    {{ post.content|safe }}

                    <!-- Post Footer with Sharing -->
                    <footer class="post-footer mt-5 d-flex flex-column flex-md-row justify-content-between align-items-center">
                        <a href="{% url 'blog:post_list' %}" class="btn btn-netflix-secondary mb-3 mb-md-0">
                            <i class="fas fa-arrow-left me-2"></i>Back to Blog
                        </a>
                        <div class="social-share">
                            <span class="fw-bold me-2">Share:</span>
                            <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri|urlencode }}&text={{ post.title|urlencode }}" target="_blank" title="Share on Twitter"><i class="fab fa-twitter"></i></a>
                            <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri|urlencode }}" target="_blank" title="Share on Facebook"><i class="fab fa-facebook-f"></i></a>
                            <a href="https://www.linkedin.com/shareArticle?mini=true&url={{ request.build_absolute_uri|urlencode }}&title={{ post.title|urlencode }}" target="_blank" title="Share on LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        </div>
                    </footer>
                </article>

                <!-- Author Box -->
                <section class="author-box">
                    <img src="https://nzdworld.com/media/media/8B0EB20D-17A9-4DE5-BD52-06B29840999E_1.png" 
                         alt="Author: {{ post.author.get_full_name|default:post.author.username }}" 
                         class="author-avatar"
                         onerror="this.onerror=null;this.src='https://placehold.co/80x80/141414/e50914?text=LWD';">
                    <div>
                        <h5 class="text-white mb-1">About the Author</h5>
                        <h4 class="text-white fw-bold">{{ post.author.get_full_name|default:post.author.username }}</h4>
                        <p class="text-white-50 mb-0">The developer behind LagosWebDev, specializing in high-performance Django applications and custom web solutions in Lagos, Nigeria. <a href="{% url 'pages:about' %}" class="text-danger">Learn more</a>.</p>
                    </div>
                </section>

                <!-- Comments Section -->
                <section class="comments-section">
                    <div class="netflix-card p-4">
                        <h4 class="text-white">Comments</h4>
                        <p class="text-white-50">The comments system is currently under development. Please check back soon!</p>
                        <!-- Your comment form and list will go here -->
                    </div>
                </section>
            </div>
        </div>
    </div>
</div>
{% endblock %}
